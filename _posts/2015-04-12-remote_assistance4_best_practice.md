---
layout: post
title: 実家のWindows PCをネット越しに世話する(4) ～ 共有フォルダとバッチの組合せ事例
excerpt_separator: <!--more-->
tags:
- Windows
- RemoteAssistance
---

このエントリーは、これまでに書いてきた下記3つのエントリーの続きになります。

  {% include rmas_links.md %}

- [実家のWindows PCをネット越しに世話する(1) ～ リモート アシスタンスのおさらい]
[rmas1]
- [実家のWindows PCをネット越しに世話する(2) ～ 実家と共有できるフォルダを用意する][rmas2]
- [実家のWindows PCをネット越しに世話する(3) ～ バッチファイルで楽をする][rmas3]

今回は、我が家の現時点でのベスト・プラクティスとして、<br>
*共有フォルダ(Dropbox)とバッチファイルの組み合わせることで、接続手順はどうなるのか？*<br>
について説明してみます。
<!--more-->

# Step.0 バッチファイルを共有フォルダに置く

このStepは、基本的に一度だけ実行すれば、その後は毎回実行する必要はないため、Step番号を0としています。

### Dropbox向けのバッチファイルを作る

バッチファイルの作り方は[第3回][rmas3]で説明したとおりなのですが、実家PCで作った招待ファイルをDropbox経由で簡単に受け取るため、次のように内容を書き換えます。

{% highlight sh %}
msra.exe /saveasfile %USERPROFILE%\Dropbox\招待.msrcIncident test00
{% endhighlight %}

このように書くと、**招待ファイルが共有フォルダに保存される**ようになります。<br>
実家PCでのDropboxインストール時に、デフォルトのままインストールしていれば、このバッチファイルそのままで問題ありません。(末尾のパスワード`test00`は適宜書き換えてください)

もし、Dropboxフォルダとして別のフォルダにした場合には、上記`%USERPROFILE%\Dropbox`の部分をそのフォルダのパスに置き換えてください。

### 作ったバッチファイルを共有フォルダにコピーする

作ったバッチファイルを実家PCに送る必要があるのですが、*それを簡単にするための共有フォルダ*が今はある訳です。これを使わない手はありません。

まず、[第2回][rmas2]で紹介した手順に従って、WebブラウザでDropboxにログインします。<br>
ログインに成功したら、Webブラウザにフォルダの中身が表示されますので、その画面にバッチファイルを（エクスプローラーから）ドラッグ＆ドロップでコピーすればOKです。

[![バッチファイルをDropboxにコピーする][1]][1]

  [1]: /images/rmas/copy_bat_to_dropbox.png

以上で、初回だけ必要な準備が整いました。<br>
次のステップ以降が、接続する度に実行する作業手順になります。

# Step.1 実家でバッチファイルを実行してもらう

### やってもらうことは簡単

実家PCで、招待ファイルを作成するバッチファイルを実行してもらいましょう。

1. 共有フォルダ(Dropbox)を開く。
2. その中に入っているバッチファイルをダブルクリックする。

これだけです。

### 実際の画面の例

実家PCで、あなたが（あるいは代理の人が）[第2回][rmas2]の手順通りにDropboxをインストールしていたら、実家PCのデスクトップには「Dropbox」というショートカット・アイコンができているはずです。

[![デスクトップにショートカットができている][2]][2]

  [2]: /images/rmas/shortcut_to_db_folder.png

このアイコンをダブルクリックしてもらいましょう。<br>
そうすると、そのフォルダの中に、あなたがStep.0で（Dropbox）共有フォルダに置いたバッチファイルが見えるはずです。

このバッチファイルをダブルクリックで実行してもらいましょう。

[![共有フォルダ内のバッチファイルを実行][3]][3]

  [3]: /images/rmas/exec_bat_file.png

これにより、実家PCでは下図のように「Windowsリモートアシスタンス」が起動します。<br>
あなたからのアクション（接続リクエスト）を待ち受ける状態になりますので、少し待ってもらいましょう。

[![リモートアシスタンスの起動][4]][4]

  [4]: /images/rmas/wait_for_request.png


# Step.2 実家PCとの接続を確立する

このStepでは、実家PCの画面があなたのPCから閲覧できるようになるまでの手順を説明します。

次のような流れになります。

1. あなたが「招待ファイル」を使って実家PCに接続リクエストを送る
2. そのリクエストを実家PCで承認してもらう

これだけで、実家PCの画面があなたのPCに表示されます。<br>
以下、実際の画面例を見ていきましょう。

### 「招待ファイル」を使ってあなたから接続をリクエストする

実家でバッチファイルを（ダブルクリックで）実行してもらったことで、共有フォルダに招待ファイルができているはずです。<br>
このファイルは先ほどまでは無かったものですが、実家の操作によってこのフォルダに招待ファイルができるように、Step.0でバッチファイルを仕組んだのです。

このファイルをダウンロードするために、まずはクリックしましょう。

[![招待ファイルをダウンロードする][5]][5]

  [5]: /images/rmas/download_invitation_file.png

Webブラウザが次のような表示になりますので、「ダウンロード」を選び、適当なフォルダにダウンロードします。(ex.ダウンロード・フォルダなど)。

[![ダウンロードボタンを選ぶ][5.2]][5.2]

  [5.2]: /images/rmas/select_download.png

そして、ダウンロードした招待ファイルをダブルクリックして、実家に接続リクエストを送りましょう。

[![招待ファイルをダブルクリック][5.3]][5.3]

  [5.3]: /images/rmas/double_click_inv_file.png

すると、次のようにパスワードを聞いてきますので、バッチファイルの末尾で設定したパスワード（`test00`など）を入力します。

[![パスワード入力][5.5]][5.5]

  [5.5]: /images/rmas/password_to_connect.png

これで、実家PCに接続リクエストが送られました。

### 実家で接続リクエストを承認してもらう

あながた接続リクエストを送ると、実家PCでは次のような問い合わせが表示されます。<br>
ここはぜひ、「はい」を選んでもらいましょう！

[![実家での接続承認][6]][6]

  [6]: /images/rmas/accept_request.png

これでめでたく、リモート アシスタンス接続が確立しました。

### 繋がったとき、何が起きるのか？

#### 実家PCでは…

まず、実家PCでは、画面の壁紙が黒くなるかもしれません。少なくとも、うちではそうなりました。

特に実害は無く、接続が切れたら元に戻りますので、実家の家族には慌てないように伝えましょう。

[![接続後、背景が黒に][7]][7]

  [7]: /images/rmas/background_turns_black.png

#### あなたのPCでは…

一方、あなたのPCには、実家PCの画面が表示されます。

[![実家PCの画面が閲覧できる][8]][8]

  [8]: /images/rmas/desktop_on_desktop.png

ただし、この状態だと実家PCの**画面を閲覧できるだけ**です。<br>
まだ**操作**はできません。

実家PCを操作できるようにするため、次のStepで「操作リクエスト」を送ります。

# Step.3 実家PCを操作できるようにする

いよいよこれが最後のStepです。<br>
ここでやることは、Step.2とほとんど同じ。

1. あなたが実家PCに操作リクエストを送る
2. そのリクエストを実家PCで承認してもらう

これだけです。<br>
以下、実際の画面例を見ていきましょう。

### あなたから実家に「操作リクエスト」を送る

あなたのPC上で、実家PCの画面が映るようになったウィンドウ左上隅に、「制御の要求」というメニュー項目があります。<br>
これを押して、実家に操作リクエストを送りましょう。

[![操作リクエストの送信][9]][9]

  [9]: /images/rmas/send_control_request.png

### 実家で操作リクエストを承認してもらう

あなたが操作リクエストを送ると、実家PCでは次のような問い合わせが表示されます。<br>
ここでは、チェックボックスでチェックを入れてもらって、「はい」を選んでもらいましょう。

[![実家での操作リクエスト承認][10]][10]

  [10]: /images/rmas/accept_control_request.png

これで、あなたのPCから実家PCの操作ができるようになったのではないでしょうか？

以上で、手順の説明は終わりです。<br>
あとは、あなたの思うように実家のPCをお世話してください！

# まとめ

これまで、4回にわたって「実家のPCとリモートアシスタンス接続するための方法」についてあれこれ紹介してきました。

[第2回][rmas2]で導入した「共有フォルダ」と、[第3回][rmas3]で導入した「バッチファイル」の効果によって、実家の家族にお願いする作業は…

- 共有フォルダを開いてもらい、その中のバッチファイルをダブルクリックで実行してもらう。(Step.1)
- あなたが送った接続リクエストを、「はい」ボタンを押すことで承認してもらう。(Step.2)
- あなたが送った操作リクエストを、（一カ所チェックを入れて）「はい」ボタンを押すことで承認してもらう。(Step.3)

全部挙げてもここまで減らすことができます。

これぐらいなら「うちの実家でもできそうだ」という気がしてきませんか？<br>
実際、右クリックもドラッグ＆ドロップも知らないうちの実家でも、これなら大丈夫なんです。

「実家のPCをリモートで世話できればいいのになぁ」と思っているならば、ダメ元でぜひ一度トライしてみてください。

