---
layout: post
title: 実家のWindows PCをネット越しに世話する(1) ～ リモート アシスタンスのおさらい
tags:
- Windows
- RemoteAssistance
---

**「実家のPCを、自宅からリモートで世話できたらいいのに！」**と考えたことがある人は多いのではないでしょうか？

画面の操作をどんなに電話で説明しても、PCに不慣れな実家の家族に自分がイメージしている操作を実行してもらうことは難しいですよね。いっそのこと、実家のPCをネット越しに自分で操作できたら、どんなに楽か！

Windowsには、そうした操作を行うための「リモート アシスタンス」という機能が標準で用意されています。ただ、実家とその「リモート アシスタンス」接続を確立するまでの道のりが、これまた一筋縄ではいきません…(T_T)。<br>
「トライしたけどダメだった」という経験をしたことがある人もいると思います。

私も何度も失敗を重ねましたが、何とか実家の実家のWindows PCに接続して、リモートでお世話できるところまでこぎ着けました。

[![実家のPCが見えている様子](/images/rmas/remote_desktop_result.png)](/images/rmas/remote_desktop_result.png)


この成功に至ったノウハウと事例を、数回のエントリーに分割して紹介していきたいと思います。<br>
初回の今回は、「実家の家族に十分なPCスキルがある場合」という**かなり無茶な設定**で、「そもそもリモート アシスタンス接続を確立するにはどういう作業が必要になるのか？」という流れを説明してみます。

(どうすれば実家の家族の作業を簡略化できるか？については、次回から紹介していきます。)


# リモート アシスタンス接続のおさらい

リモートアシスタンスの使い方を学ぶ上で私が参考にしたのは、下記の@ITの記事です。スクリーンショットが多く、設定すべき項目や注意点が細部まで行き渡っていて、とても助かりました。

<div class="sharelink" style="padding: 6px; border: 1px solid #aaaaaa;  margin: 0px 0px 50px;"><a href="http://www.atmarkit.co.jp/ait/articles/1203/16/news134.html" title="Windows TIPS：リモート・アシスタンスの使い方（Windows 7編） - ＠IT" target="_blank"><img src="http://capture.heartrails.com/120x90/shadow?http://www.atmarkit.co.jp/ait/articles/1203/16/news134.html" width="120" height="90" style="float: left;"></a><a href="http://www.atmarkit.co.jp/ait/articles/1203/16/news134.html" title="Windows TIPS：リモート・アシスタンスの使い方（Windows 7編） - ＠IT" target="_blank">Windows TIPS：リモート・アシスタンスの使い方（Windows 7編） - ＠IT</a><a href="http://b.hatena.ne.jp/entry/http://www.atmarkit.co.jp/ait/articles/1203/16/news134.html"><img src="http://b.hatena.ne.jp/entry/image/http://www.atmarkit.co.jp/ait/articles/1203/16/news134.html" alt="はてなブックマーク - Windows TIPS：リモート・アシスタンスの使い方（Windows 7編） - ＠IT" title="はてなブックマーク - Windows TIPS：リモート・アシスタンスの使い方（Windows 7編） - ＠IT"></a><br style="clear: both;" /></div>

この記事の流れに沿って、リモートアシスタンス接続までの手順を一通り見ていきます。

なお、「お世話する側」と「お世話受ける側」について、上記記事と本エントリーでは次のように読み替えてください。

| 参考元の記事での呼び方 | 本エントリーでの呼び方 |
| ---------------------- | ---------------------- |
| ヘルプを要求する側 | 実家 |
| ヘルプする側 | あなた |

###Step.0 事前確認

接続手順の0番目として、実家側のPCでリモートアシスタンスによる外部からの操作を許可しているかどうか確認してもらいます。(以降の手順と違って、これは一度だけ確認すれば(わざわざ設定を書き換えない限り)二度と気にする必要は無いため、Step番号を0としています。)

コントロールパネルから、[システムとセキュリティ]→[システム]→[リモートアクセスの許可]を開いてもらいます。

![システムのプロパティ画面](/images/rmas/system_property.png)

この画面で、「このコンピューターへのリモート アシスタンス接続を許可する」にチェックが入っていることを確認してもらいます。入ってなければ、チェックしてもらいます。

###Step.1 実家PCで「招待状」を作ってもらう

このStep.1以降が、接続にトライする度に実行することになる手順です。

Step.1では、次のことを実家の家族に行ってもらいます。

1. スタートメニューから「Windowsリモートアシスタンス」を起動する。
2. 起動した「Windowsリモートアシスタンス」で招待状を作成・保存する。  
もしここでファイアウォールの設定を変更すべきことが判明したら、「おまけStep.x」の手順で設定を変更し、その後再び1からやり直す。

では、画面の例を見ながら手順を追っていきましょう。
- - -

まず、実家PCで「Windowsリモートアシスタンス」を開いてもらいます。<br>
スタートメニューから[メンテナンス]→[Windowsリモートアシスタンス]を選んでもらってください。

![スタートメニューからリモートアシスタンスを起動](/images/rmas/start_menu.png)

すると、次のような「Windowsリモートアシスタンス」画面が開きます。

[![リモートアシスタンス画面](/images/rmas/rmas_top.png)](/images/rmas/rmas_top.png)

二つ選択肢がありますが、実家は**あなたを招待して助けてもらう**側なので、上の方の「信頼するヘルパーを招待します」を選んでもらいましょう。


ここでもし次のようなエラーが出たら、リモートアシスタンスを受け入れられるようにファイアウォールを設定する必要があります。<br>
本エントリー末尾の「おまけStep.x」の手順で、この問題を解決してから、次に進みましょう。

[![リモートアシスタンス画面](/images/rmas/fail_to_invite.png)](/images/rmas/fail_to_invite.png)

さて、上図のようなエラーが出なかったか、あるいは出たけれども、「おまけStep.x」の手順で解決した後にやり直している、とします。<br>
すると、次のような画面が出てくるはずです。

[![招待方法を選ぶ画面](/images/rmas/select_how_to_invite.png)](/images/rmas/select_how_to_invite.png)

ここでは「この招待をファイルに保存する」を選ぶことにしましょう。<br>
(「電子メールを使用して招待を送信する」は、メールソフトとしてOutlookを使っていない場合、面倒なことになるのです。)

すると、次のようなファイル保存ダイアログが開きます。そのまま「保存」ボタンを押してもらい、招待ファイルを「ドキュメント ライブラリ」に保存しましょう。

[![招待ファイルの保存](/images/rmas/save_invitation_file.png)](/images/rmas/save_invitation_file.png)

すると、次のような「着信接続待ち」状態の画面が開きます。<br>
その中には、リモートアシスタンスの接続を確立する際にあなたが入力する必要があるパスワード(値はその時々で変わります)が表示されているはずです。

[![ヘルパーからの要求待ち受け](/images/rmas/waiting_helper.png)](/images/rmas/waiting_helper.png)

ここまで来たら、やっとStep.1が終了です。<br>
一息入れたいところですが、ここで作った「招待ファイル」と「パスワード」の組合せには、有効期限があります。(デフォルトでは6時間です。)<br>
有効期限が切れる前に、Step.2以降も一通り済ませるようにしましょう。


###Step.2 招待ファイルとパスワードを実家から受け取る

このステップでやるべきことはシンプル。実家の家族が作った「招待ファイル」と「パスワード」の二つを受け取るだけです。<br>
ですが、実はここで引っかかったりするのです。

####招待ファイルを受け取る

パソコンを使っている実家の家族だったら、あなたとメールをやりとりした経験はあるでしょう。<br>
だったら、「ドラッグ＆ドロップ」さえできれば、招待ファイルは送ってもらえます。Step.1の通りに操作していたら、招待ファイルは「ライブラリ」下の「ドキュメント」フォルダ内にできているはずです。エクスプローラーで確認してもらいましょう。

[![招待ファイルのありか](/images/rmas/inv_file_in_my_documnet.png)](/images/rmas/inv_file_in_my_documnet.png)

この`招待.msrcIncident`を送信メール画面にドラッグ＆ドロップで添付してもらい、そのメールを送ってもらうだけです。楽勝！<br>
…と思いきや、うちの場合はここを越えられませんでした。実家の家族が「ドラッグ＆ドロップ」を知らず、その操作を電話で説明しようとしてもできなかったのです。

結局、次回以降のエントリーで紹介する回避策を採用したので、メールに添付せずに招待ファイルを受け取れるようになりました。<br>
ですので、うちの家族は未だにドラッグ＆ドロップができないままです…。

####パスワードを受け取る

招待ファイルを受け取ることと比べれば、こっちはまだマシです。<br>
英数字で12文字のパスワードをメールにコピペして送ってもらえばいいですし、最悪でも電話で読み上げてもらえばいいんです。

パスワードのコピーは、パスワードが書かれているエリアで右クリックすると出てくるメニューの「パスワードのコピー」を選べばOKです。

[![招待ファイルのありか](/images/rmas/copy_password.png)](/images/rmas/copy_password.png)

ただし…

- 実家の家族は「コピー＆ペースト」を知っているでしょうか？知らないことだってありえます。(うちの実家の場合は知りませんでした)
- コピペが使えない場合、パスワードを読み上げてもらうことになりますが、電話で正しくパスワードが伝わることは期待できるでしょうか？  
例えば、「B(ビー)」と「D(ディー)」を正確に聞き分けられるでしょうか？

こんなところにも、罠は潜んでいたのでした。

繰り返しになりますが、このStep.2を切り抜ける仕掛けについては、次回以降のエントリーで紹介します。<br>
ここは、たまたま実家の家族に十分なスキルがあり、あなたが何とか「招待ファイル」と「パスワード」を受け取ることができたと仮定して、次のステップの説明に移ります。

###Step.3 リモート アシスタンス接続の要求と承認

お待たせしました。ようやくあなたのPCの登場です。<br>
Step.3では、次のことを行います。

1. あなたが「招待ファイル」を使って、あなたのPC上でリモートアシスタンスを起動する。
2. あなたが、実家PCの画面を**閲覧**するリクエストを実家に送る。
3. 実家PCで、そのリクエストを承認してもらう。
4. あなたが、実家PCを**操作**するリクエストを実家に送る。
5. 実家PCで、そのリクエストも承認してもらう。

では、画面の例を見ながら手順を追っていきましょう。
- - -

あなたのPC上で、実家から送られてきた「招待ファイル」をダブルクリックし、リモートアシスタンスを起動します。(フォルダ名などは一例だと思ってください)

[![招待ファイルのダブルクリック](/images/rmas/launch_helper_rmas.png)](/images/rmas/launch_helper_rmas.png)

すると、すぐにパスワードの入力を求められます。「招待ファイル」とペアで実家から受け取ったパスワードを入力しましょう。

[![パスワードの入力](/images/rmas/password_required.png)](/images/rmas/password_required.png)

これにより、実家のPCを**閲覧**するためのリクエストが実家PCに送られます。

実家PCでは、次のようなダイアログが表示されるはずです。<br>
ここでは、実家の家族にぜひ「はい」を選んでもらいましょう。

[![閲覧承認ダイアログ](/images/rmas/accept_browse_request.png)](/images/rmas/accept_browse_request.png)

すると、あなたのPCに、実家PCの画面が映し出されます。

[![接続の確立](/images/rmas/connection_established.png)](/images/rmas/connection_established.png)

これで、リモート アシスタンス接続を確立できたことになります！<br>
実家のPCには、次のように「あなたが閲覧している」旨が表示されているはずです。

[![ヘルパーが閲覧中](/images/rmas/helper_is_browsing.png)](/images/rmas/helper_is_browsing.png)

また、実家PCの背景画像が消えて、背景が真っ黒になっているかもしれません。それで問題ありませんので、その旨を実家の家族に伝えましょう。

しかし、これだけだと「実家の画面を**見られるだけ**」です。まだ、**操作**することはできません。

実家PCを操作するには、そのためのリクエストを実家に送る必要があります。<br>
あなたのPC上で、リモートアシスタンス画面の左上部のメニューを見てみてください。「制御の要求」という項目が見つかるはずです。

![制御の要求ボタン](/images/rmas/button_to_request_control.png)

これを選ぶと、実家に「操作するためのリクエスト」が送られます。

実家PCでは、次のような画面が出ているはずです。<br>
チェックボックスのチェックを入れてもらい、「はい」でリクエストを承認してもらいましょう。

[![制御要求が来た](/images/rmas/control_request.png)](/images/rmas/contorl_request.png)

あなたのPCから実家PCを操作できるようになったのではないでしょうか？<br>
これで、実家のPCのお世話をあなたができるようになりました！お疲れさまです！

- - -
- - -

###おまけStep.x 「ヘルパーを招待します」でエラーになった場合の対処

このStepでは、次のことを実家の家族に行ってもらいます。

1. ファイアウォールの設定変更を指示するためのボタンを押す(かなり簡単)
2. 設定変更が終わったら、Step.1の最初に戻る

- - -

もしStep.1で次のような画面が出てきたら、あなたをヘルパーとして招待できるように、ファイアウォールの設定を変更する必要があります。<br>
この場合には、「修復」ボタンを押してもらいましょう。

[![招待に失敗→修復ボタンを押す](/images/rmas/fail_to_invite_then_push.png)](/images/rmas/fail_to_invite_then_push.png)

次のように、やはりファイアウォールが原因だと判明したら、「これらの修復方法を管理者として実行する」を選んでもらいます。

[![失敗の原因はファイアウォール設定](/images/rmas/diag_result.png)](/images/rmas/diag_result.png)

途中で管理者権限の確認があるかもしれませんが、基本的にはこの診断ツールが自動でファイアウォールの設定を書き換えてくれます。<br>
次のような画面が出たら、ファイアウォール問題は解決です。<br>
(もしこれで解決しない場合は、お使いのセキュリティソフトによって解決方法が異なってしまいます。ググるなどして、解決方法を見つけてください。)

[![ファイアウォール問題解決！](/images/rmas/firewall_problem_fixed.png)](/images/rmas/firewall_problem_fixed.png)

「トラブルシューティング ツールを終了する」を選んでもらい、Step.1を最初から繰り返しましょう。今度は、同じエラーは出ないはずです。

# まとめ

このエントリーでは、「実家の家族にそこそこPCスキルがある」というちょっとムリめな前提を置いて、リモートアシスタンス接続を確立するための手順をおさらいしました。

- Step.1 実家PCで招待ファイルとパスワードを作成してもらう
- Step.2 実家から招待ファイルとパスワードを受け取る
- Step.3 受け取った招待ファイルを使って、実家PCとの接続を確立する。

「こんなにたくさんやることがあるのか…」と感じられたかもしれません。<br>
でも、実際に「添付ファイル付きのメールを送れて、コピペも分かる人」と電話などで会話しながら進めてみると、意外とスムーズにできてしまうと思います。<br>
ハードルの高い実家PCとの接続を試す前に、まずは友人宅のPCと接続の練習をしてみることをオススメします。

  {% include rmas_links.md %}

[次回][rmas2]からは、「実家の家族はドラッグ＆ドロップ操作もコピペも知らない」という状況下で私が仕組んだ仕掛けについて紹介してきます。

続き（次回）はこちらから。↓
<div class="sharelink" style="padding: 6px; border: 1px solid #aaaaaa;  margin: 0px 0px 50px;"><a href="http://blog.sato0123.com/2015/04/01/remote_assistance2-shared-folder/" title="実家のWindows PCをネット越しに世話する(2) ～ 実家と共有できるフォルダを用意する · Yoshi's Notes" target="_blank"><img src="http://capture.heartrails.com/120x90/shadow?http://blog.sato0123.com/2015/04/01/remote_assistance2-shared-folder/" width="120" height="90" style="float: left;"></a><a href="http://blog.sato0123.com/2015/04/01/remote_assistance2-shared-folder/" title="実家のWindows PCをネット越しに世話する(2) ～ 実家と共有できるフォルダを用意する · Yoshi's Notes" target="_blank">実家のWindows PCをネット越しに世話する(2) ～ 実家と共有できるフォルダを用意する · Yoshi's Notes</a><a href="http://b.hatena.ne.jp/entry/http://blog.sato0123.com/2015/04/01/remote_assistance2-shared-folder/"><img src="http://b.hatena.ne.jp/entry/image/http://blog.sato0123.com/2015/04/01/remote_assistance2-shared-folder/" alt="はてなブックマーク - 実家のWindows PCをネット越しに世話する(2) ～ 実家と共有できるフォルダを用意する · Yoshi's Notes" title="はてなブックマーク - 実家のWindows PCをネット越しに世話する(2) ～ 実家と共有できるフォルダを用意する · Yoshi's Notes"></a><br style="clear: both;" /></div>